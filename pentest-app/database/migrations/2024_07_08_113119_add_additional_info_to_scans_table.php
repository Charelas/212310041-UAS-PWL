<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::table('scans', function (Blueprint $table) {
            if (!Schema::hasColumn('scans', 'whois_info')) {
                $table->text('whois_info')->nullable();
            }
            if (!Schema::hasColumn('scans', 'geoip_info')) {
                $table->text('geoip_info')->nullable();
            }
            if (!Schema::hasColumn('scans', 'reverse_dns_info')) {
                $table->text('reverse_dns_info')->nullable();
            }
            if (!Schema::hasColumn('scans', 'vulnerability_info')) {
                $table->json('vulnerability_info')->nullable();
            }
            if (!Schema::hasColumn('scans', 'web_content_info')) {
                $table->json('web_content_info')->nullable();
            }
            if (!Schema::hasColumn('scans', 'url_reputation')) {
                $table->json('url_reputation')->nullable();
            }
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::table('scans', function (Blueprint $table) {
            if (Schema::hasColumn('scans', 'whois_info')) {
                $table->dropColumn('whois_info');
            }
            if (Schema::hasColumn('scans', 'geoip_info')) {
                $table->dropColumn('geoip_info');
            }
            if (Schema::hasColumn('scans', 'reverse_dns_info')) {
                $table->dropColumn('reverse_dns_info');
            }
            if (Schema::hasColumn('scans', 'vulnerability_info')) {
                $table->dropColumn('vulnerability_info');
            }
            if (Schema::hasColumn('scans', 'web_content_info')) {
                $table->dropColumn('web_content_info');
            }
            if (Schema::hasColumn('scans', 'url_reputation')) {
                $table->dropColumn('url_reputation');
            }
        });
    }
};
